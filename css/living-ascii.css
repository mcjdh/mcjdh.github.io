/* Living ASCII Art Animations - Performance Optimized */
/* Mathematical timing based on sacred constants */

:root {
    --golden-ratio: 1.618;
    --phi-seconds: 2s; /* Slower for better performance */
    --pi-seconds: 4s;
    --fibonacci-1: 1.5s;
    --fibonacci-2: 2.5s;
    --fibonacci-3: 4s;
    --fibonacci-5: 6s;
    --fibonacci-8: 8s;
}

/* Performance optimizations */
* {
    will-change: auto; /* Let browser decide */
}

.living-element {
    transform: translateZ(0); /* GPU acceleration when needed */
}

/* Viewport-responsive text sizing */
.ascii-art {
    font-size: clamp(0.6rem, 1.5vw, 1rem);
    line-height: 1.2;
    overflow: visible;
}

.portal-title {
    font-size: clamp(1.5rem, 4vw, 2.5rem) !important;
}

.realm-symbol {
    font-size: clamp(2rem, 5vw, 3rem) !important;
}

.nexus-symbol {
    font-size: clamp(3rem, 6vw, 4rem) !important;
}

/* Breathing Border Effects */
.breathing-border {
    animation: border-breathe var(--phi-seconds) ease-in-out infinite;
}

@keyframes border-breathe {
    0%, 100% { 
        opacity: 0.7;
        transform: scale(1);
        filter: brightness(0.8);
    }
    50% { 
        opacity: 1;
        transform: scale(1.02);
        filter: brightness(1.2);
    }
}

/* Sacred Symbol Pulsing */
.sacred-pulse {
    animation: sacred-pulse var(--phi-seconds) ease-in-out infinite;
}

@keyframes sacred-pulse {
    0%, 100% { 
        transform: scale(1);
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        opacity: 0.8;
    }
    50% { 
        transform: scale(1.1);
        text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        opacity: 1;
    }
}

/* Golden Ratio Rotation */
.golden-rotate {
    animation: golden-rotate calc(var(--phi-seconds) * 8) linear infinite;
    transform-origin: center;
}

@keyframes golden-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Mathematical Equation Flow */
.equation-flow .symbol {
    animation: equation-pulse var(--fibonacci-2) ease-in-out infinite;
}

.equation-flow .symbol:nth-child(1) { animation-delay: 0s; }
.equation-flow .symbol:nth-child(2) { animation-delay: 0.2s; }
.equation-flow .symbol:nth-child(3) { animation-delay: 0.4s; }
.equation-flow .symbol:nth-child(4) { animation-delay: 0.6s; }
.equation-flow .symbol:nth-child(5) { animation-delay: 0.8s; }

@keyframes equation-pulse {
    0%, 100% { 
        transform: translateY(0) scale(1);
        opacity: 0.7;
    }
    50% { 
        transform: translateY(-2px) scale(1.05);
        opacity: 1;
    }
}

/* Infinity Flow */
.infinity-flow {
    animation: infinity-trace var(--fibonacci-5) ease-in-out infinite;
}

@keyframes infinity-trace {
    0% { transform: translateX(0); }
    25% { transform: translateX(3px) scale(1.05); }
    50% { transform: translateX(0) scale(1.1); }
    75% { transform: translateX(-3px) scale(1.05); }
    100% { transform: translateX(0); }
}

/* Constellation Breathing */
.constellation-node {
    animation: constellation-breathe var(--fibonacci-3) ease-in-out infinite;
}

.constellation-node:nth-child(1) { animation-delay: 0s; }
.constellation-node:nth-child(2) { animation-delay: 0.3s; }
.constellation-node:nth-child(3) { animation-delay: 0.6s; }
.constellation-node:nth-child(4) { animation-delay: 0.9s; }
.constellation-node:nth-child(5) { animation-delay: 1.2s; }

@keyframes constellation-breathe {
    0%, 100% { 
        transform: scale(1);
        opacity: 0.6;
        filter: brightness(0.8);
    }
    50% { 
        transform: scale(1.2);
        opacity: 1;
        filter: brightness(1.5);
    }
}

/* Portal Energy Flow - Viewport Aware */
.portal-energy {
    position: relative;
    overflow: visible; /* Changed from hidden */
}

.portal-energy::before {
    content: '';
    position: fixed; /* Changed from absolute */
    top: 0;
    left: -100vw; /* Use viewport units */
    width: 300vw; /* Wider sweep */
    height: 100vh;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.05), 
        transparent);
    animation: energy-sweep var(--fibonacci-5) ease-in-out infinite;
    pointer-events: none;
    z-index: -1; /* Behind content */
}

@keyframes energy-sweep {
    0% { left: -100vw; }
    100% { left: 100vw; }
}

/* Cymatics Resonance - Simplified */
.cymatics-live {
    font-family: monospace;
    line-height: 1;
    letter-spacing: 1px;
}

.cymatics-node {
    display: inline-block;
    animation: cymatics-wave var(--fibonacci-3) ease-in-out infinite;
}

.cymatics-node:nth-child(3n) { animation-delay: 0.5s; }
.cymatics-node:nth-child(3n+1) { animation-delay: 1s; }

@keyframes cymatics-wave {
    0%, 100% { 
        opacity: 0.6;
        transform: scale(1);
    }
    50% { 
        opacity: 0.9;
        transform: scale(1.05);
    }
}

/* Living Waveform */
.live-waveform {
    white-space: pre;
    font-family: monospace;
    line-height: 1.2;
}

.wave-char {
    display: inline-block;
    animation: wave-oscillate var(--fibonacci-2) ease-in-out infinite;
}

@keyframes wave-oscillate {
    0%, 100% { transform: translateY(0px); opacity: 0.6; }
    50% { transform: translateY(-1px); opacity: 0.9; }
}

/* Fractal Growth */
.fractal-branch {
    animation: fractal-grow var(--fibonacci-8) ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes fractal-grow {
    0% { 
        transform: scale(0.8);
        opacity: 0.5;
    }
    50% { 
        transform: scale(1.1);
        opacity: 1;
    }
    100% { 
        transform: scale(0.8);
        opacity: 0.5;
    }
}

/* Harmonic Grid */
.harmonic-grid .cell {
    animation: harmonic-pulse var(--fibonacci-2) ease-in-out infinite;
}

.harmonic-grid .cell:nth-child(3n+1) { animation-delay: 0s; }
.harmonic-grid .cell:nth-child(3n+2) { animation-delay: 0.33s; }
.harmonic-grid .cell:nth-child(3n+3) { animation-delay: 0.66s; }

@keyframes harmonic-pulse {
    0%, 100% { 
        transform: scale(1);
        filter: brightness(0.8);
    }
    50% { 
        transform: scale(1.05);
        filter: brightness(1.3);
    }
}

/* Quantum Superposition */
.quantum-state {
    animation: quantum-fluctuate 2s ease-in-out infinite;
}

@keyframes quantum-fluctuate {
    0% { opacity: 1; content: '●'; }
    25% { opacity: 0.7; content: '◉'; }
    50% { opacity: 0.3; content: '○'; }
    75% { opacity: 0.7; content: '◐'; }
    100% { opacity: 1; content: '●'; }
}

/* Sacred Geometry Rotation */
.sacred-geometry {
    animation: sacred-rotate var(--fibonacci-8) linear infinite;
}

@keyframes sacred-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Yin-Yang Continuous Rotation */
.yin-yang-flow {
    animation: yin-yang-rotate var(--pi-seconds) linear infinite;
}

@keyframes yin-yang-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Binary Stream Flow */
.binary-stream .bit {
    animation: binary-flip var(--fibonacci-1) step-end infinite;
}

.binary-stream .bit:nth-child(even) { animation-delay: 0.5s; }

@keyframes binary-flip {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0.3; }
}

/* Mathematical Series Flow */
.series-flow .term {
    animation: series-emerge var(--fibonacci-3) ease-in-out infinite;
}

.series-flow .term:nth-child(1) { animation-delay: 0s; }
.series-flow .term:nth-child(2) { animation-delay: 0.2s; }
.series-flow .term:nth-child(3) { animation-delay: 0.4s; }
.series-flow .term:nth-child(4) { animation-delay: 0.6s; }
.series-flow .term:nth-child(5) { animation-delay: 0.8s; }

@keyframes series-emerge {
    0% { 
        transform: scale(0.8);
        opacity: 0.4;
    }
    50% { 
        transform: scale(1.1);
        opacity: 1;
    }
    100% { 
        transform: scale(0.8);
        opacity: 0.4;
    }
}

/* Responsive breathing adjustments */
@media (max-width: 768px) {
    :root {
        --phi-seconds: 2s;
        --pi-seconds: 4s;
        --fibonacci-1: 1.2s;
        --fibonacci-2: 2s;
        --fibonacci-3: 3s;
        --fibonacci-5: 5s;
        --fibonacci-8: 8s;
    }
}

/* Reduced animations for performance */
.reduced-animations .wave-char,
.reduced-animations .cymatics-node,
.reduced-animations .constellation-node,
.reduced-animations .fractal-branch,
.reduced-animations .quantum-state,
.reduced-animations .series-flow .term {
    animation: none;
}

.reduced-animations .portal-energy::before {
    animation: none;
}

/* Simplified animations for low-performance devices */
.reduced-animations .breathing-border {
    animation: simple-breathe 3s ease-in-out infinite;
}

.reduced-animations .sacred-pulse {
    animation: simple-pulse 2s ease-in-out infinite;
}

@keyframes simple-breathe {
    0%, 100% { opacity: 0.8; }
    50% { opacity: 1; }
}

@keyframes simple-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.02); }
}

/* No animations class for emergency performance */
.no-animations * {
    animation: none !important;
    transition: none !important;
    transform: none !important;
}

.no-animations .portal-energy::before {
    display: none;
}

/* Connection Lines - Browser Optimized */
.connection-lines {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: visible;
}

.connection-line {
    position: absolute;
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
    transform-origin: left center;
    animation: pulse-line 4s ease-in-out infinite;
    will-change: opacity;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

@keyframes pulse-line {
    0%, 100% { opacity: 0.1; }
    50% { opacity: 0.3; }
}

/* Browser-specific optimizations */
@supports (-webkit-appearance: none) {
    /* WebKit browsers (Safari, Chrome) */
    .portal-energy::before {
        -webkit-transform: translateZ(0);
    }
}

@supports (-moz-appearance: none) {
    /* Firefox */
    .connection-line {
        transform-style: preserve-3d;
    }
}

/* Cross-browser viewport fixes */
@media screen and (max-width: 100vw) {
    .realm-portals {
        width: 100%;
        max-width: 100vw;
        overflow: visible;
    }
    
    .gateway-container {
        width: 100%;
        max-width: 100vw;
        box-sizing: border-box;
    }
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    * {
        animation: none !important;
        transition: none !important;
    }
    
    .portal-energy::before {
        display: none;
    }
}